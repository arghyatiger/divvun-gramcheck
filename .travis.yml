language: cpp

# Ubuntu 14.04 Trusty support, for C++11 (clang at least)
sudo: required
dist: trusty

compiler:
    - clang
    - gcc

os:
    - linux
    - osx

before_script:
    - echo "$TRAVIS_OS_NAME"
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]];then wget http://apertium.projectjj.com/apt/install-nightly.sh -O - | sudo bash; fi
    - if [[ "$TRAVIS_OS_NAME" == "linux" ]];then sudo apt-get -f install -y libhfst45-dev libpugixml-dev; fi
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]];then wget http://apertium.projectjj.com/osx/install-nightly.sh -O - | sudo bash; fi
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]];then sudo brew update; fi
    - if [[ "$TRAVIS_OS_NAME" == "osx" ]];then sudo brew install pugixml; fi
    - ./autogen.sh

env:
    - LD_LIBRARY_PATH="${LD_LIBRARY_PATH}:/usr/local/lib" PKG_CONFIG_PATH="${PKG_CONFIG_PATH}:/usr/local/share/pkgconfig:/usr/local/lib/pkgconfig" ACLOCAL_PATH="${ACLOCAL_PATH}:/usr/local/share/aclocal" PATH="${PATH}:/usr/local/bin"

matrix:
    allow_failures:
        - os: linux
# Trusty doesn't have C++11, gcc nor clang :-/
